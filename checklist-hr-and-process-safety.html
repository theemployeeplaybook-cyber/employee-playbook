<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR &amp; Process Safety Checklist | The Employee Playbook</title>

    <!-- ICONS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.png">
    <link rel="icon" type="image/png" href="assets/img/favicon.png">

    <style>
        /* ===========================
           ROOT VARIABLES (Brand)
        =========================== */
        :root {
            --primary-white: #FFFFFF;
            --light-gray: #F8F9FA;
            --medium-gray: #E9ECEF;
            --dark-gray: #6C757D;
            --text-dark: #212529;
            --text-medium: #495057;

            --accent-purple: #7B5FC4;
            --accent-purple-dark: #5A4496;
            --light-purple: #E6E0F5;
            --lighter-purple: #F0EBFA;

            --border-light: rgba(0, 0, 0, 0.08);
            --nav-bg: rgba(255, 255, 255, 0.95);
            --hero-bg: linear-gradient(135deg, #F9F6FF 0%, #F0EBFA 100%);
            --premium-gradient: linear-gradient(135deg, #7B5FC4 0%, #5A4496 100%);

            --success-green: #10b981;
            --warning-orange: #f59e0b;
            --danger-red: #ef4444;
            --info-blue: #3b82f6;

            /* Category accents (TEP – 9 categories) */
            --cat-clarity: #7B5FC4;      /* Workload Clarity & Direction */
            --cat-burnout: #F59E0B;      /* Burnout & Capacity */
            --cat-manager: #10B981;      /* Manager Behaviour */
            --cat-politics: #3B82F6;     /* Workplace Dynamics & Politics */
            --cat-team: #84CC16;         /* Team Issues */
            --cat-boundaries: #06B6D4;   /* Boundaries & Overextension */
            --cat-hr: #6D28D9;           /* HR & Performance */
            --cat-confidence: #EF4444;   /* Confidence & Influence */
            --cat-decision: #800020;     /* Decision Making & Career Path */
        }

        /* Dark Mode Variables */
        .dark-mode {
            --primary-white: #1a1a1a;
            --light-gray: #2a2a2a;
            --medium-gray: #3a3a3a;
            --dark-gray: #888888;
            --text-dark: #e0e0e0;
            --text-medium: #b0b0b0;

            --accent-purple: #9d86e9;
            --accent-purple-dark: #7b5fc4;
            --light-purple: rgba(123, 95, 196, 0.2);
            --lighter-purple: rgba(123, 95, 196, 0.1);

            --border-light: rgba(255, 255, 255, 0.08);
            --nav-bg: rgba(30, 30, 30, 0.95);
            --hero-bg: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
            --premium-gradient: linear-gradient(135deg, #9d86e9 0%, #7b5fc4 100%);

            /* Category accents (TEP – 9 categories, dark mode) */
            --cat-clarity: #9D86E9;
            --cat-burnout: #FBBF24;
            --cat-manager: #34D399;
            --cat-politics: #60A5FA;
            --cat-team: #A3E635;
            --cat-boundaries: #22D3EE;
            --cat-hr: #8B5CF6;
            --cat-confidence: #F87171;
            --cat-decision: #B03060;
        }

        /* ===========================
           GLOBAL STYLES
        =========================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        body {
            background-color: var(--primary-white);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
            opacity: 0;
            transition: opacity 0.35s ease;
            min-height: 100vh;
        }

        body.loaded { opacity: 1; }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ===========================
           NAVIGATION
        =========================== */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: var(--nav-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 1000;
            border-bottom: 1px solid var(--border-light);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s ease, border-color 0.3s ease;
            height: 80px;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            height: 100%;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            height: 100%;
        }

        .logo-img {
            height: 100px;
            width: auto;
            transform: translateX(20%);
            padding: 14px 10px;
            transition: all 0.3s ease;
            display: block;
            min-height: 100px;
        }

        .logo-fallback {
            display: none;
            align-items: center;
            justify-content: center;
            height: 48px;
            padding: 0 14px;
            border-radius: 10px;
            background: var(--premium-gradient);
            color: #fff;
            font-weight: 800;
            letter-spacing: 0.8px;
            font-size: 13px;
            text-transform: uppercase;
            transform: translateX(20%);
        }

        .nav-links {
            display: flex;
            gap: 50px;
        }

        .nav-link {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            font-size: 17px;
        }

        .nav-link:hover { color: var(--accent-purple); }

        .nav-link-container {
            position: relative;
            display: inline-block;
        }

        .new-tag {
            position: absolute;
            top: -12px;
            right: -35px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #000;
            font-size: 10px;
            font-weight: 800;
            padding: 2px 6px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            z-index: 10;
            white-space: nowrap;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 24px;
            transform: translateX(-20%);
        }

        .header-cta {
            background: var(--accent-purple);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(123, 95, 196, 0.3);
        }

        .header-cta:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(123, 95, 196, 0.35);
        }

        .sign-in {
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 500;
            font-size: 17px;
        }

        .sign-in:hover { color: var(--accent-purple); }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-dark);
            cursor: pointer;
            font-size: 16px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .theme-toggle:hover { background-color: var(--light-gray); }

        .mobile-toggle {
            display: none;
            background: none;
            border: none;
            color: var(--text-dark);
            cursor: pointer;
            font-size: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease;
        }

        .mobile-toggle:hover { background-color: var(--light-gray); }

        .mobile-sign-in,
        .mobile-sign-up { display: none; }

        @media (max-width: 768px) {
            .nav-container { justify-content: center; position: relative; }

            .logo {
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                display: flex;
                align-items: center;
                height: 100%;
            }

            .logo-img { height: 125px; transform: none; padding: 12px 0; }
            .logo-fallback { transform: none; }

            .mobile-toggle {
                display: flex;
                position: absolute;
                left: 20px;
                align-items: center;
            }

            .nav-actions {
                transform: none;
                gap: 16px;
                position: absolute;
                right: 20px;
                align-items: center;
            }

            .nav-actions .sign-in,
            .nav-actions .header-cta { display: none; }

            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: var(--nav-bg);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                flex-direction: column;
                padding: 20px;
                border-top: 1px solid var(--border-light);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                gap: 20px;
            }

            .nav-links.active { display: flex; }

            .nav-link-container {
                display: flex;
                align-items: center;
                justify-content: flex-start;
                width: 100%;
            }

            .new-tag { position: static; margin-left: 8px; }

            .mobile-sign-in {
                display: block !important;
                margin-top: 10px;
                padding: 12px 20px;
                background: var(--primary-white);
                color: var(--accent-purple);
                border-radius: 10px;
                text-align: center;
                font-weight: 700;
                text-decoration: none;
                border: 2px solid var(--accent-purple);
                transition: all 0.3s ease;
            }

            .mobile-sign-up {
                display: block !important;
                margin-top: 10px;
                padding: 12px 20px;
                background: var(--accent-purple);
                color: white;
                border-radius: 10px;
                text-align: center;
                font-weight: 700;
                text-decoration: none;
                border: 2px solid var(--accent-purple);
                transition: all 0.3s ease;
            }
        }

        /* ===========================
           HERO
        =========================== */
        .tool-hero-section {
            width: 100%;
            background: var(--hero-bg);
            padding: 20px 0 30px;
            margin-top: 110px;
            position: relative;
            border-bottom: 1px solid var(--border-light);
            overflow: hidden;
        }

        .tool-hero-section::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(250, 245, 255, 0.85) 0%, rgba(245, 240, 255, 0.6) 50%, rgba(255, 255, 255, 0.25) 100%);
            z-index: 1;
        }

        .dark-mode .tool-hero-section::before {
            background: linear-gradient(135deg, rgba(42, 42, 42, 0.9) 0%, rgba(31, 31, 31, 0.7) 50%, rgba(26, 26, 26, 0.4) 100%);
        }

        .tool-hero-content {
            position: relative;
            z-index: 2;
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px 10px;
            animation: heroFadeUp 0.45s ease-out;
        }

        @keyframes heroFadeUp {
            from { opacity: 0; transform: translateY(18px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .breadcrumb {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--dark-gray);
            margin-bottom: 10px;
            display: flex;
            gap: 6px;
            align-items: center;
            flex-wrap: wrap;
        }

        .breadcrumb a {
            color: var(--text-medium);
            text-decoration: none !important;
            font-weight: 600;
            letter-spacing: 0.6px;
            transition: color 0.2s ease;
        }

        .breadcrumb a:hover { color: var(--accent-purple-dark); }

        .breadcrumb i { font-size: 10px; opacity: 0.7; }
        .breadcrumb .current { color: var(--text-dark); font-weight: 600; }

        .checklist-name {
            font-size: 14px;
            font-weight: 700;
            color: var(--accent-purple);
            text-transform: uppercase;
            letter-spacing: 1.8px;
            margin: 18px 0 12px;
            display: block;
        }

        .hero-main-heading {
            font-size: 46px;
            font-weight: 650;
            color: var(--text-dark);
            line-height: 1.1;
            margin-bottom: 18px;
            max-width: 820px;
        }

        .hero-subheading {
            font-size: 16px;
            color: var(--text-medium);
            line-height: 1.6;
            max-width: 860px;
            margin-bottom: 26px;
        }

        /* Save button anchored to hero */
        .save-btn {
            position: absolute;
            top: 16px;
            right: 24px;
            z-index: 5;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 600;
            border-radius: 999px;
            border: 1px solid rgba(123, 95, 196, 0.6);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            color: var(--accent-purple-dark);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .save-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(123, 95, 196, 0.18);
            background: #ffffff;
        }

        .dark-mode .save-btn {
            background: rgba(20, 20, 20, 0.9);
            border-color: rgba(157, 134, 233, 0.6);
        }

        .save-btn.saved {
            background: var(--accent-purple);
            color: #ffffff;
            border-color: transparent;
        }

        /* Category Pills (Brand colours) */
        .category-pills-container { margin-bottom: 10px; }
        .category-pills-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-medium);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            display: block;
        }

        .category-pills-grid {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .category-pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: 1px solid transparent;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            text-decoration: none;
            height: 34px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
            cursor: pointer;
            white-space: nowrap;
        }

        .dark-mode .category-pill { background: rgba(255, 255, 255, 0.08); }

        .category-pill:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
            text-decoration: none;
        }

        .category-icon { font-size: 12px; opacity: 0.9; flex-shrink: 0; }

        /* HR & Performance */
        .category-pill.hr{
            color: var(--cat-hr);
            border-color: rgba(109, 40, 217, 0.25);
            background: linear-gradient(135deg, rgba(109, 40, 217, 0.10), rgba(109, 40, 217, 0.04));
        }
        .dark-mode .category-pill.hr{
            border-color: rgba(139, 92, 246, 0.45);
            background: linear-gradient(135deg, rgba(109, 40, 217, 0.22), rgba(109, 40, 217, 0.10));
        }

        /* Decision Making & Career Path */
        .category-pill.decision{
            color: var(--cat-decision);
            border-color: rgba(128, 0, 32, 0.22);
            background: linear-gradient(135deg, rgba(128, 0, 32, 0.10), rgba(128, 0, 32, 0.04));
        }
        .dark-mode .category-pill.decision{
            border-color: rgba(176, 48, 96, 0.45);
            background: linear-gradient(135deg, rgba(128, 0, 32, 0.22), rgba(128, 0, 32, 0.10));
        }

        /* Confidence & Influence */
        .category-pill.confidence{
            color: var(--cat-confidence);
            border-color: rgba(239, 68, 68, 0.22);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.10), rgba(239, 68, 68, 0.04));
        }
        .dark-mode .category-pill.confidence{
            border-color: rgba(239, 68, 68, 0.45);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.20), rgba(239, 68, 68, 0.10));
        }

        /* ===========================
           CONTEXT & PRO TIPS
        =========================== */
        .context-tips-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 40px;
            width: 100%;
            max-width: 1100px;
            margin: 0 auto 50px;
            padding: 24px 20px 10px;
            margin-top: 6px;
        }

        .context-card, .tips-card {
            background: var(--primary-white);
            border: 1px solid var(--border-light);
            border-radius: 14px;
            padding: 28px 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i { color: var(--accent-purple); }

        .bullet-list { list-style: none; margin: 0; padding: 0; }
        .bullet-list li {
            color: var(--text-medium);
            line-height: 1.65;
            margin-bottom: 12px;
            padding-left: 26px;
            position: relative;
            font-size: 14.5px;
            font-weight: 450;
        }
        .bullet-list li::before {
            content: "•";
            position: absolute;
            left: 10px;
            color: var(--accent-purple);
            font-size: 18px;
        }

        /* ===========================
           CHECKLIST BODY
        =========================== */
        .checklist-body {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 20px 20px;
        }

        .checklist-section-title {
            font-size: 26px;
            font-weight: 750;
            color: var(--accent-purple-dark);
            margin: 56px 0 18px;
        }

        .checklist-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
            counter-reset: tepStep;
        }

        .checklist-item {
            position: relative;
            background: var(--primary-white);
            padding: 14px 16px 14px 52px;
            border-radius: 12px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
            border: 1px solid var(--border-light);
            display: flex;
            gap: 12px;
            align-items: flex-start;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
            cursor: pointer;
            height: 100%;
            min-height: 72px;
        }

        .checklist-item::before {
            counter-increment: tepStep;
            content: counter(tepStep);
            position: absolute;
            left: 14px;
            top: 14px;
            width: 28px;
            height: 28px;
            border-radius: 10px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 12px;
            color: var(--accent-purple-dark);
            background: linear-gradient(135deg, rgba(123, 95, 196, 0.16), rgba(123, 95, 196, 0.06));
            border: 1px solid rgba(123, 95, 196, 0.22);
        }

        .dark-mode .checklist-item::before {
            color: var(--accent-purple);
            background: linear-gradient(135deg, rgba(123, 95, 196, 0.22), rgba(123, 95, 196, 0.10));
            border-color: rgba(157, 134, 233, 0.30);
        }

        .checklist-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 26px rgba(0,0,0,0.08);
            border-color: rgba(123, 95, 196, 0.25);
        }

        .checklist-item i {
            color: var(--accent-purple);
            font-size: 18px;
            margin-top: 3px;
            flex-shrink: 0;
        }

        .checklist-text {
            flex: 1;
            color: var(--text-medium);
            font-size: 14.6px;
            line-height: 1.55;
            font-weight: 450;
        }

        /* ===========================
           LEFT STEP SIDEBAR (glide out)
        =========================== */
        .step-sidebar-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.35);
            z-index: 1185;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.22s ease;
        }

        .step-sidebar-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }

        .step-sidebar {
            position: fixed;
            top: 0;
            left: -420px;
            width: 390px;
            max-width: 92vw;
            height: 100%;
            z-index: 1186;
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            border-right: 1px solid var(--border-light);
            box-shadow: 6px 0 26px rgba(0,0,0,0.18);
            transition: left 0.24s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .dark-mode .step-sidebar {
            background: rgba(18, 18, 18, 0.96);
            box-shadow: 8px 0 28px rgba(0,0,0,0.55);
        }

        .step-sidebar.open { left: 0; }

        .step-sidebar-topbar {
            padding: 18px 18px 14px;
            border-bottom: 1px solid var(--border-light);
            position: relative;
        }

        .step-sidebar-topbar::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 3px;
            background: var(--premium-gradient);
        }

        .step-top-row {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 10px;
        }

        .step-chip {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 8px 10px;
            border-radius: 12px;
            background: rgba(123, 95, 196, 0.10);
            border: 1px solid rgba(123, 95, 196, 0.18);
            width: 100%;
        }

        .dark-mode .step-chip {
            background: rgba(123, 95, 196, 0.18);
            border-color: rgba(157, 134, 233, 0.22);
        }

        .step-badge {
            width: 32px;
            height: 32px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 12px;
            color: #fff;
            background: var(--premium-gradient);
            flex-shrink: 0;
            box-shadow: 0 10px 22px rgba(123, 95, 196, 0.22);
        }

        .step-chip-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
            min-width: 0;
        }

        .step-chip-title {
            font-size: 14px;
            font-weight: 800;
            color: var(--text-dark);
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .step-chip-sub {
            font-size: 12px;
            color: var(--text-medium);
            font-weight: 500;
        }

        .step-close-btn {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 18px;
            border-radius: 999px;
            width: 34px;
            height: 34px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
            flex-shrink: 0;
        }

        .step-close-btn:hover { background: var(--light-gray); }

        .step-sidebar-body {
            padding: 14px 16px 18px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .step-card {
            background: var(--primary-white);
            border: 1px solid var(--border-light);
            border-radius: 14px;
            padding: 14px 14px;
            box-shadow: 0 10px 26px rgba(0,0,0,0.05);
        }

        .dark-mode .step-card { box-shadow: 0 12px 28px rgba(0,0,0,0.28); }

        .step-card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 0.6px;
            text-transform: uppercase;
            color: var(--accent-purple-dark);
            margin-bottom: 8px;
        }

        .step-card-title i { opacity: 0.95; }

        .step-card p,
        .step-card li {
            font-size: 13.5px;
            color: var(--text-medium);
            line-height: 1.6;
            font-weight: 450;
        }

        .step-mini-list {
            list-style: none;
            margin: 8px 0 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .step-mini-list li {
            padding-left: 22px;
            position: relative;
        }

        .step-mini-list li::before {
            content: "•";
            position: absolute;
            left: 8px;
            top: 0;
            color: var(--accent-purple);
            font-size: 16px;
            line-height: 1.2;
        }

        .step-sidebar-footer {
            padding: 12px 16px 16px;
            border-top: 1px solid var(--border-light);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            background: rgba(255,255,255,0.7);
        }

        .dark-mode .step-sidebar-footer { background: rgba(18,18,18,0.7); }

        .step-footer-btn {
            border: none;
            padding: 10px 12px;
            border-radius: 12px;
            font-weight: 750;
            font-size: 13px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
        }

        .step-footer-btn.primary {
            background: var(--premium-gradient);
            color: #fff;
            box-shadow: 0 12px 26px rgba(123,95,196,0.22);
        }

        .step-footer-btn.primary:hover { transform: translateY(-1px); box-shadow: 0 16px 30px rgba(123,95,196,0.28); }

        .step-footer-btn.secondary {
            background: var(--light-purple);
            color: var(--accent-purple-dark);
        }

        .dark-mode .step-footer-btn.secondary {
            background: rgba(123, 95, 196, 0.22);
            color: var(--accent-purple);
        }

        .step-footer-btn.secondary:hover {
            transform: translateY(-1px);
            background: rgba(123, 95, 196, 0.18);
        }

        .step-footer-btn:disabled {
            opacity: 0.55;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* ===========================
           PROCESS SAFETY SCORE
        =========================== */
        .clarity-score-section {
            max-width: 1100px;
            margin: 25px auto 40px;
            padding: 0 20px;
        }

        .presence-snapshot-header { margin-bottom: 18px; text-align: left; }
        .presence-snapshot-header h2 {
            font-size: 22px;
            font-weight: 800;
            color: var(--accent-purple-dark);
            margin-bottom: 6px;
        }
        .presence-snapshot-header p {
            font-size: 14px;
            color: var(--text-medium);
            max-width: 1100px;
            line-height: 1.55;
            font-weight: 450;
        }

        .clarity-score-bar {
            display: flex;
            align-items: stretch;
            gap: 30px;
            background: var(--primary-white);
            border-radius: 16px;
            padding: 22px 24px 20px;
            box-shadow: 0 14px 40px rgba(123, 95, 196, 0.12);
            border: 1px solid rgba(123, 95, 196, 0.15);
        }

        .clarity-progress-container { flex: 1.4; }

        .clarity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .clarity-title { font-size: 18px; font-weight: 700; color: var(--accent-purple-dark); }
        .clarity-percentage { font-size: 28px; font-weight: 600; color: var(--accent-purple); }

        .progress-container {
            height: 10px;
            background: var(--light-gray);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .dark-mode .progress-container { background: rgba(255, 255, 255, 0.12); }

        .progress-fill {
            height: 100%;
            background: var(--premium-gradient);
            width: 0%;
            border-radius: 5px;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .progress-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--dark-gray);
        }

        .presence-dimensions {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 10px;
            margin-top: 14px;
        }

        .presence-dimension-pill {
            border-radius: 12px;
            padding: 8px 10px;
            border: 1px solid var(--border-light);
            background: var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: var(--text-medium);
        }

        .dark-mode .presence-dimension-pill {
            background: rgba(255,255,255,0.04);
            border-color: rgba(255,255,255,0.1);
        }

        .presence-dimension-pill span.label { font-weight: 600; color: var(--text-dark); }
        .presence-dimension-pill span.score { font-weight: 600; color: var(--accent-purple); }

        .actions-container {
            display: flex;
            gap: 12px;
            flex-shrink: 0;
            flex-direction: column;
            justify-content: center;
            align-items: stretch;
            max-width: 260px;
        }

        .action-btn {
            background: var(--premium-gradient);
            color: white;
            border: none;
            padding: 10px 18px;
            font-size: 13.5px;
            border-radius: 12px;
            font-weight: 750;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.25s ease;
            width: 100%;
            justify-content: center;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 14px 26px rgba(123, 95, 196, 0.28);
        }

        .action-btn.secondary {
            background: var(--light-purple);
            color: var(--accent-purple-dark);
        }

        .dark-mode .action-btn.secondary {
            background: rgba(123, 95, 196, 0.21);
            color: var(--accent-purple);
        }

        .action-btn.secondary:hover { background: var(--accent-purple); color: white; }
        .action-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; box-shadow: none !important; }

        .progress-fill.high { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .progress-fill.medium { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .progress-fill.low { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }

        /* ===========================
           SMART SUMMARY
        =========================== */
        .smart-summary-section {
            max-width: 1100px;
            margin: 0 auto 60px;
            padding: 0 20px;
            display: none;
        }

        .smart-summary-section.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .summary-header { text-align: center; margin-bottom: 28px; }
        .summary-title { font-size: 24px; font-weight: 700; color: var(--accent-purple-dark); margin-bottom: 6px; }
        .summary-subtitle { color: var(--text-medium); font-size: 15px; margin-bottom: 8px; font-weight: 450; }
        .summary-insight { font-size: 13.5px; color: var(--dark-gray); max-width: 740px; margin: 0 auto; line-height: 1.6; }

        .section-header {
            font-size: 18px;
            font-weight: 850;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-gray);
        }

        .section-header.red { color: var(--danger-red); }
        .section-header.purple { color: var(--accent-purple-dark); }
        .section-header.blue { color: var(--accent-purple); }

        .red-flags-grid,
        .next-steps-grid,
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .red-flag-card,
        .next-step-card,
        .resource-card {
            background: var(--primary-white);
            border-radius: 14px;
            padding: 18px;
            border: 1px solid rgba(0,0,0,0.06);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100%;
            box-shadow: 0 14px 30px rgba(0,0,0,0.06);
        }

        .dark-mode .red-flag-card,
        .dark-mode .next-step-card,
        .dark-mode .resource-card {
            border-color: rgba(255,255,255,0.08);
            box-shadow: 0 18px 34px rgba(0,0,0,0.32);
        }

        .red-flag-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .next-step-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--premium-gradient); }
        .resource-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--premium-gradient); }

        .flag-icon, .step-icon, .resource-icon {
            font-size: 18px;
            margin-bottom: 14px;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flag-icon { color: #ef4444; background: rgba(239, 68, 68, 0.10); }
        .step-icon, .resource-icon { color: var(--accent-purple); background: var(--lighter-purple); }

        .flag-title, .step-title, .resource-title { font-size: 15px; font-weight: 700; color: var(--text-dark); margin-bottom: 8px; }
        .flag-description, .step-description, .resource-description { color: var(--text-medium); font-size: 13.5px; line-height: 1.55; flex-grow: 1; font-weight: 450; }

        .resource-card { transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .resource-card:hover { transform: translateY(-3px); box-shadow: 0 18px 34px rgba(123, 95, 196, 0.14); }

        .resource-link {
            color: var(--accent-purple);
            font-weight: 800;
            text-decoration: none;
            font-size: 13.5px;
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: auto;
        }

        .resource-link:hover { text-decoration: underline; }

        /* ===========================
           MY PLAYBOOK FAB + SIDEBAR (Right)
        =========================== */
        .my-playbook-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 1200;
            background: var(--premium-gradient);
            color: #ffffff;
            padding: 10px 16px;
            border-radius: 999px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 750;
            box-shadow: 0 10px 25px rgba(0,0,0,0.25);
            transition: all 0.25s ease;
        }

        .my-playbook-fab:hover {
            transform: translateY(-3px);
            box-shadow: 0 14px 30px rgba(0,0,0,0.32);
        }

        .playbook-sidebar-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.45);
            z-index: 1190;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease;
        }

        .playbook-sidebar-overlay.open { opacity: 1; pointer-events: auto; }

        .playbook-sidebar {
            position: fixed;
            top: 0;
            right: -380px;
            width: 340px;
            max-width: 90%;
            height: 100%;
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            box-shadow: -4px 0 20px rgba(0,0,0,0.25);
            z-index: 1191;
            display: flex;
            flex-direction: column;
            border-left: 1px solid var(--border-light);
            transition: right 0.25s ease;
        }

        .dark-mode .playbook-sidebar { background: rgba(18, 18, 18, 0.96); box-shadow: -4px 0 22px rgba(0,0,0,0.6); }
        .playbook-sidebar.open { right: 0; }

        .playbook-sidebar-header {
            padding: 20px 20px 14px;
            border-bottom: 1px solid var(--border-light);
        }

        .playbook-sidebar-header-title-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .playbook-sidebar-header h3 { font-size: 18px; font-weight: 700; color: var(--text-dark); }
        .playbook-sidebar-header p { font-size: 13px; color: var(--dark-gray); }

        .playbook-close-btn {
            background: none;
            border: none;
            color: var(--dark-gray);
            cursor: pointer;
            font-size: 18px;
            border-radius: 999px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }

        .playbook-close-btn:hover { background: var(--light-gray); }

        .playbook-sidebar-body {
            padding: 14px 18px 20px;
            padding-bottom: 50px;
            overflow-y: auto;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .saved-items-empty { font-size: 13px; color: var(--dark-gray); line-height: 1.6; }

        .saved-items-list { list-style: none; margin: 0; padding: 0; }

        .saved-item {
            padding: 10px 10px 10px;
            border-radius: 12px;
            border: 1px solid var(--border-light);
            background: var(--primary-white);
            box-shadow: 0 1px 4px rgba(0,0,0,0.04);
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .saved-item-title-row {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 6px;
        }

        .saved-item-title { font-size: 14px; font-weight: 700; color: var(--text-dark); }
        .saved-item-type {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.6px;
            color: var(--accent-purple-dark);
            font-weight: 600;
        }

        .saved-item-meta { font-size: 12px; color: var(--dark-gray); }

        .saved-item-link {
            margin-top: 6px;
            font-size: 12px;
            color: var(--accent-purple);
            text-decoration: none;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .saved-item-link:hover { text-decoration: underline; }

        .playbook-quick-links {
            margin-top: 223px;
            padding-top: 10px;
            border-top: 1px solid var(--border-light);
        }

        .quick-links-title {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-medium);
        }

        .playbook-quick-links-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 8px;
        }

        .quick-link-pill {
            width: 58%;
            padding: 8px 12px;
            border-radius: 999px;
            border: 1px solid rgba(123, 95, 196, 0.35);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.08),rgba(123, 95, 196, 0.02));
            text-decoration: none;
            color: var(--accent-purple-dark);
            font-size: 13px;
            font-weight: 650;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .quick-link-pill:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 22px rgba(0,0,0,0.12);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.16), rgba(123, 95, 196, 0.06));
        }

        .dark-mode .quick-link-pill {
            border-color: rgba(157, 134, 233, 0.55);
            background: linear-gradient(135deg,rgba(123, 95, 196, 0.26),rgba(123, 95, 196, 0.12));
        }

        /* ===========================
           FOOTER
        =========================== */
        footer {
            background: var(--primary-white);
            padding: 10px 0;
            border-top: 1px solid var(--border-light);
            margin-top: 30px;
            text-align: center;
            color: var(--text-medium);
        }

        /* ===========================
           RESPONSIVE
        =========================== */
        @media (max-width: 1024px) {
            .context-tips-grid { grid-template-columns: 1fr; gap: 24px; }
            .red-flags-grid, .next-steps-grid, .resources-grid { grid-template-columns: repeat(2, 1fr); }
            .checklist-grid { grid-template-columns: 1fr; }
            .clarity-score-bar { flex-direction: column; }
            .actions-container { max-width: 100%; flex-direction: row; }
        }

        @media (max-width: 768px) {
            .tool-hero-section { margin-top: 100px; }
            .hero-main-heading { font-size: 36px; }
            .clarity-score-bar { padding: 18px; }
            .actions-container { flex-direction: column; }
            .red-flags-grid, .next-steps-grid, .resources-grid { grid-template-columns: 1fr; }
            .save-btn { right: 18px; top: 10px; }
            .my-playbook-fab { bottom: 18px; right: 18px; }
        }

        @media (max-width: 480px) {
            .hero-main-heading { font-size: 32px; }
            .checklist-name { font-size: 13px; }
            .presence-dimensions { grid-template-columns: 1fr; }
            .checklist-item { padding-left: 50px; }
            .checklist-item::before { border-radius: 10px; }
            .step-sidebar { width: 92vw; }
        }
    </style>
</head>

<body>

<!-- ===========================
     NAVIGATION
=========================== -->
<nav>
    <div class="container nav-container">
        <button class="mobile-toggle" aria-label="Open menu"><i class="fas fa-bars"></i></button>

        <a href="index.html" class="logo" aria-label="The Employee Playbook">
            <img src="./assets/img/logo.png" alt="The Employee Playbook" class="logo-img" id="mainLogo">
            <div class="logo-fallback" id="logoFallback">The Employee Playbook</div>
        </a>

        <div class="nav-links">
            <a href="the-lens.html" class="nav-link">The Lens</a>
            <a href="the-toolkit.html" class="nav-link">The Toolkit</a>
            <div class="nav-link-container">
                <a href="the-coach.html" class="nav-link">The Coach</a>
                <span class="new-tag">NEW</span>
            </div>
            <a href="the-shift.html" class="nav-link">The Shift</a>
            <a href="the-pricing.html" class="nav-link">The Pricing</a>
            <a href="sign-in.html" class="mobile-sign-in">Sign In</a>
            <a href="create-account.html" class="mobile-sign-up">Sign Up</a>
        </div>

        <div class="nav-actions">
            <a href="create-account.html" class="header-cta">Sign up</a>
            <a href="sign-in.html" class="sign-in">Sign in</a>
            <button class="theme-toggle" id="themeToggleBtn" aria-label="Toggle theme"><i class="fas fa-moon"></i></button>
        </div>
    </div>
</nav>

<!-- ===========================
     HERO
=========================== -->
<div class="tool-hero-section">
    <button class="save-btn" id="saveBtn">
        <i class="far fa-bookmark"></i>
        <span>Save</span>
    </button>

    <div class="tool-hero-content">
        <div class="breadcrumb">
            <a href="the-toolkit.html">Toolkit</a>
            <i class="fas fa-chevron-right"></i>
            <a href="category-hr-and-formal-processes.html">HR &amp; Formal Processes</a>
            <i class="fas fa-chevron-right"></i>
            <span class="current">HR &amp; Process Safety Checklist</span>
        </div>

        <span class="checklist-name">HR &amp; PROCESS SAFETY CHECKLIST</span>

        <h1 class="hero-main-heading">Protect your position by playing the process clean</h1>

        <div class="hero-subheading">
            HR processes don’t just measure “what happened” — they measure what can be evidenced, what was raised when, and how you behaved inside the rules.
            This checklist helps you stay calm, documented, and procedurally safe when you’re facing performance pressure, conflict, investigations, restructures, or “managed out” tactics.
        </div>

        <div class="category-pills-container">
            <span class="category-pills-title">Related Categories</span>
            <div class="category-pills-grid">

                <a href="category-confidence-presence-influence.html" class="category-pill confidence">
                    <i class="fas fa-bolt category-icon"></i>
                    <span>Confidence, Presence &amp; Influence</span>
                </a>
                <a href="category-career-playbook.html" class="category-pill decision">
                    <i class="fas fa-route category-icon"></i>
                    <span>Career Playbook</span>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- ===========================
     CONTEXT & PRO TIPS
=========================== -->
<div class="context-tips-grid">
    <div class="context-card">
        <h3 class="section-title"><i class="fas fa-shield-halved"></i>When to Use This Checklist</h3>
        <ul class="bullet-list">
            <li>When a manager starts “process-y” behaviour: vague concerns, sudden scrutiny, shifting goals, or informal warnings.</li>
            <li>When you’re entering a formal stage: investigation, disciplinary, grievance, capability, performance plan, restructure consultation.</li>
            <li>When you suspect the outcome is being engineered (managed out, retaliation, quiet firing, calibration-driven exits).</li>
            <li>When you need to protect yourself while staying professional and employable (tone, evidence, timelines, consistency).</li>
            <li>Before important meetings with HR so you avoid making admissions, agreeing to unfair framing, or missing deadlines.</li>
        </ul>
    </div>

    <div class="tips-card">
        <h3 class="section-title"><i class="fas fa-lightbulb"></i>Pro Tips</h3>
        <ul class="bullet-list">
            <li>Process safety is leverage: calm tone + documented facts + on-time responses.</li>
            <li>Assume every note could be quoted later. Write as if it will be read by someone neutral.</li>
            <li>Never rely on “verbal agreements”. Confirm outcomes and next steps in writing.</li>
            <li>Keep a single timeline: dates, meetings, requests, decisions, and evidence links.</li>
            <li>Be hard on facts, soft on tone. Professional language protects credibility.</li>
        </ul>
    </div>
</div>

<!-- ===========================
     CHECKLIST BODY
=========================== -->
<div class="checklist-body" id="checklistText">
    <h2 class="checklist-section-title">Your HR &amp; Process Safety Checklist</h2>

    <div class="checklist-grid">
        <div class="checklist-item" data-category="process">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I know which process is actually in play (performance/capability, conduct/disciplinary, grievance, restructure/consultation) and what the stages are.
            </div>
        </div>

        <div class="checklist-item" data-category="process">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I have the key documents: relevant policies, my job description, objectives/OKRs, any warnings, and any meeting invites/letters.
            </div>
        </div>

        <div class="checklist-item" data-category="timeline">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I’m tracking timelines: deadlines, notice periods, meeting dates, who said what when, and what I’m required to respond to.
            </div>
        </div>

        <div class="checklist-item" data-category="evidence">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I have an evidence pack: outcomes, work products, metrics, feedback, and a tidy chronology (links/screenshots where needed).
            </div>
        </div>

        <div class="checklist-item" data-category="comms">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I am keeping my communications “tribunal-safe”: factual, calm, non-accusatory, and consistent (no emotional spikes, no essays).
            </div>
        </div>

        <div class="checklist-item" data-category="comms">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                After key meetings, I send a short written recap: what was discussed, what was agreed, and the next steps + timelines.
            </div>
        </div>

        <div class="checklist-item" data-category="process">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I’m clear on my rights in meetings: whether I can bring a companion/rep, ask for adjustments, or request questions in advance (where appropriate).
            </div>
        </div>

        <div class="checklist-item" data-category="risk">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I’ve identified the narrative risk: what they might be trying to prove (capability, attitude, “fit”, reliability) and the evidence they’re using.
            </div>
        </div>

        <div class="checklist-item" data-category="evidence">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I am separating facts vs interpretation: I can challenge claims with dates, examples, and proof — without debating emotions.
            </div>
        </div>

        <div class="checklist-item" data-category="support">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I have support in place: trusted colleague, union/rep (if applicable), or an adviser — and I’m not navigating alone.
            </div>
        </div>

        <div class="checklist-item" data-category="risk">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I’m protecting my health + capacity: if stress/illness is relevant, I’m documenting it and using the correct route (GP notes, adjustments, workload evidence).
            </div>
        </div>

        <div class="checklist-item" data-category="decision">
            <i class="far fa-square"></i>
            <div class="checklist-text">
                I have a decision path: what I’m trying to achieve (repair, reset, transfer, exit) and what “good outcome” looks like across 30/60/90 days.
            </div>
        </div>
    </div>
</div>

<!-- ===========================
     LEFT STEP SIDEBAR
=========================== -->
<div class="step-sidebar-overlay" id="stepOverlay" aria-hidden="true">
    <aside class="step-sidebar" id="stepSidebar" aria-label="Step details panel">
        <div class="step-sidebar-topbar">
            <div class="step-top-row">
                <div class="step-chip">
                    <div class="step-badge" id="stepBadge">1</div>
                    <div class="step-chip-text">
                        <div class="step-chip-title" id="stepTitle">Step title</div>
                        <div class="step-chip-sub" id="stepSubtitle">Click “Mark complete” if this is true for you.</div>
                    </div>
                </div>
                <button class="step-close-btn" id="closeStepSidebar" aria-label="Close step panel">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <div class="step-sidebar-body">
            <div class="step-card">
                <div class="step-card-title"><i class="fas fa-bullseye"></i>Focus</div>
                <p id="stepFocus"></p>
            </div>

            <div class="step-card">
                <div class="step-card-title"><i class="fas fa-lightbulb"></i>What strong looks like</div>
                <ul class="step-mini-list" id="stepStrong"></ul>
            </div>

            <div class="step-card">
                <div class="step-card-title"><i class="fas fa-triangle-exclamation"></i>Common slip</div>
                <p id="stepSlip"></p>
            </div>

            <div class="step-card">
                <div class="step-card-title"><i class="fas fa-bolt"></i>Micro-move</div>
                <p id="stepMicro"></p>
            </div>

            <div class="step-card">
                <div class="step-card-title"><i class="fas fa-quote-right"></i>Try this line</div>
                <p id="stepLine"></p>
            </div>

            <div class="step-card">
                <div class="step-card-title"><i class="fas fa-video"></i>Remote note</div>
                <p id="stepRemote"></p>
            </div>
        </div>

        <div class="step-sidebar-footer">
            <button class="step-footer-btn secondary" id="prevStepBtn"><i class="fas fa-arrow-left"></i> Previous</button>
            <button class="step-footer-btn secondary" id="nextStepBtn">Next <i class="fas fa-arrow-right"></i></button>
            <button class="step-footer-btn primary" id="toggleStepCompleteBtn" style="grid-column: 1 / -1;">
                <i class="fas fa-check"></i> Mark complete
            </button>
        </div>
    </aside>
</div>

<!-- ===========================
     PROCESS SAFETY SCORE
=========================== -->
<div class="clarity-score-section">
    <div class="presence-snapshot-header">
        <h2>Your Process Safety Snapshot</h2>
        <p>
            Your Process Safety Score reflects how well you’re protected if things escalate: correct process, clean timelines, usable evidence, and professional comms.
            High scores don’t guarantee fairness — they reduce vulnerability and increase options.
        </p>
    </div>

    <div class="clarity-score-bar">
        <div class="clarity-progress-container">
            <div class="clarity-header">
                <div class="clarity-title">Process Safety Score</div>
                <div class="clarity-percentage" id="clarityPercentage">0%</div>
            </div>
            <div class="progress-container">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-labels">
                <span>Exposed</span>
                <span>Partial</span>
                <span>Protected</span>
            </div>

            <div class="presence-dimensions">
                <div class="presence-dimension-pill">
                    <span class="label">Evidence &amp; Pack</span>
                    <span class="score" id="scoreVoice">0%</span>
                </div>
                <div class="presence-dimension-pill">
                    <span class="label">Process &amp; Timelines</span>
                    <span class="score" id="scoreStructure">0%</span>
                </div>
                <div class="presence-dimension-pill">
                    <span class="label">Comms &amp; Tone</span>
                    <span class="score" id="scoreNonverbal">0%</span>
                </div>
                <div class="presence-dimension-pill">
                    <span class="label">Risk &amp; Options</span>
                    <span class="score" id="scoreChallenge">0%</span>
                </div>
            </div>
        </div>

        <div class="actions-container">
            <button class="action-btn" onclick="generateSmartSummary()" id="generateBtn" disabled>
                <i class="fas fa-magic"></i> Generate summary
            </button>
            <button class="action-btn secondary" onclick="copyChecklist()" id="copyBtn">
                <i class="far fa-copy"></i> Copy checklist
            </button>
        </div>
    </div>
</div>

<!-- ===========================
     SMART SUMMARY
=========================== -->
<div class="smart-summary-section" id="smartSummary">
    <div class="summary-header">
        <h2 class="summary-title">Your Smart Process Safety Summary</h2>
        <p class="summary-subtitle">Based on your Process Safety Score of <span id="summaryScore">0%</span></p>
        <p class="summary-insight">
            This is your “procedural risk” readout. It highlights the gaps that typically get exploited in HR situations: missing evidence,
            fuzzy timelines, messy comms, and no clear decision path.
        </p>
    </div>

    <h3 class="section-header red">
        <i class="fas fa-exclamation-triangle"></i> Red Flags in Your Positioning
    </h3>
    <div class="red-flags-grid" id="redFlagsGrid"></div>

    <h3 class="section-header purple">
        <i class="fas fa-forward"></i> Next Moves to Increase Safety
    </h3>
    <div class="next-steps-grid" id="nextStepsGrid"></div>

    <h3 class="section-header blue">
        <i class="fas fa-tools"></i> Recommended Tools to Support You
    </h3>
    <div class="resources-grid" id="resourcesGrid"></div>
</div>

<!-- ===========================
     MY PLAYBOOK SIDEBAR (Right)
=========================== -->
<div class="playbook-sidebar-overlay" id="playbookOverlay">
    <div class="playbook-sidebar" id="playbookSidebar">
        <div class="playbook-sidebar-header">
            <div class="playbook-sidebar-header-title-row">
                <h3>My Playbook</h3>
                <button class="playbook-close-btn" id="closePlaybook" aria-label="Close My Playbook">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p>Saved items</p>
        </div>
        <div class="playbook-sidebar-body">
            <div id="savedItemsContainer">
                <p class="saved-items-empty" id="savedItemsEmpty">
                    You haven’t saved anything yet. Use <strong>Save</strong> on tools you want quick access to.
                </p>
                <ul class="saved-items-list" id="savedItemsList"></ul>
            </div>

            <div class="playbook-quick-links">
                <div class="playbook-quick-links-header">
                    <span class="quick-links-title">Quick links</span>
                </div>
                <div class="playbook-quick-links-list">
                    <a href="dashboard.html" class="quick-link-pill">
                        <i class="fas fa-gauge"></i> The Dashboard
                    </a>
                    <a href="the-lens.html" class="quick-link-pill">
                        <i class="fas fa-search"></i> The Lens
                    </a>
                    <a href="the-toolkit.html" class="quick-link-pill">
                        <i class="fas fa-toolbox"></i> The Toolkit
                    </a>
                    <a href="the-coach.html" class="quick-link-pill">
                        <i class="fas fa-comments"></i> The Coach
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="my-playbook-fab" id="myPlaybookButton">
    <i class="fas fa-book-open"></i>
    <span>My Playbook</span>
</div>

<!-- ===========================
     FOOTER
=========================== -->
<footer>
    <div class="container">
        <p>© 2025 The Employee Playbook. All rights reserved.</p>
    </div>
</footer>

<!-- ===========================
     JAVASCRIPT
=========================== -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    document.body.classList.add('loaded');

    initializeChecklist();
    initializeThemeToggle();
    initializeMobileNav();
    initializePlaybook();
    initializeStepSidebar();
});

/* ===========================
   MOBILE NAV
=========================== */
function initializeMobileNav() {
    const mobileToggle = document.querySelector('.mobile-toggle');
    const navLinks = document.querySelector('.nav-links');

    if (!mobileToggle || !navLinks) return;

    mobileToggle.addEventListener('click', function () {
        navLinks.classList.toggle('active');
        const icon = this.querySelector('i');
        if (icon) {
            icon.classList.toggle('fa-bars');
            icon.classList.toggle('fa-times');
        }
    });

    document.addEventListener('click', function(event) {
        if (navLinks.classList.contains('active') &&
            !navLinks.contains(event.target) &&
            !mobileToggle.contains(event.target)) {
            navLinks.classList.remove('active');
            const icon = mobileToggle.querySelector('i');
            if (icon) {
                icon.classList.add('fa-bars');
                icon.classList.remove('fa-times');
            }
        }
    });
}

/* ===========================
   THEME TOGGLE + LOGO
=========================== */
function initializeThemeToggle() {
    const themeToggleBtn = document.getElementById('themeToggleBtn');
    if (!themeToggleBtn) return;

    const themeIcon = themeToggleBtn.querySelector('i');
    const logoImg = document.getElementById('mainLogo');
    const logoFallback = document.getElementById('logoFallback');

    function getLogoPath(filename) {
        if (window.location.protocol === 'file:') {
            const currentPath = window.location.pathname;
            const basePath = currentPath.substring(0, currentPath.lastIndexOf('/') + 1);
            return basePath + 'assets/img/' + filename;
        } else {
            return './assets/img/' + filename;
        }
    }

    function showFallbackLogo() {
        if (logoImg) logoImg.style.display = 'none';
        if (logoFallback) logoFallback.style.display = 'inline-flex';
    }

    function showImageLogo() {
        if (logoFallback) logoFallback.style.display = 'none';
        if (logoImg) logoImg.style.display = 'block';
    }

    function updateLogoForTheme(isDarkMode) {
        if (!logoImg) return;
        showImageLogo();

        logoImg.src = isDarkMode ? getLogoPath('logo-dark.png') : getLogoPath('logo.png');
        logoImg.alt = 'The Employee Playbook';
    }

    const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    const savedTheme = localStorage.getItem('theme');

    const shouldUseDark = savedTheme === 'dark' || (!savedTheme && prefersDarkScheme.matches);

    if (shouldUseDark) {
        document.body.classList.add('dark-mode');
        if (themeIcon) { themeIcon.classList.remove('fa-moon'); themeIcon.classList.add('fa-sun'); }
        updateLogoForTheme(true);
    } else {
        document.body.classList.remove('dark-mode');
        if (themeIcon) { themeIcon.classList.remove('fa-sun'); themeIcon.classList.add('fa-moon'); }
        updateLogoForTheme(false);
    }

    themeToggleBtn.addEventListener('click', function() {
        const isDarkMode = document.body.classList.contains('dark-mode');

        if (isDarkMode) {
            document.body.classList.remove('dark-mode');
            localStorage.setItem('theme', 'light');
            if (themeIcon) { themeIcon.classList.remove('fa-sun'); themeIcon.classList.add('fa-moon'); }
            updateLogoForTheme(false);
        } else {
            document.body.classList.add('dark-mode');
            localStorage.setItem('theme', 'dark');
            if (themeIcon) { themeIcon.classList.remove('fa-moon'); themeIcon.classList.add('fa-sun'); }
            updateLogoForTheme(true);
        }
    });

    prefersDarkScheme.addEventListener('change', (e) => {
        if (!localStorage.getItem('theme')) {
            if (e.matches) {
                document.body.classList.add('dark-mode');
                if (themeIcon) { themeIcon.classList.remove('fa-moon'); themeIcon.classList.add('fa-sun'); }
                updateLogoForTheme(true);
            } else {
                document.body.classList.remove('dark-mode');
                if (themeIcon) { themeIcon.classList.remove('fa-sun'); themeIcon.classList.add('fa-moon'); }
                updateLogoForTheme(false);
            }
        }
    });

    if (logoImg) {
        logoImg.addEventListener('error', function() {
            if (this.src.includes('logo-dark.png')) {
                this.src = getLogoPath('logo.png');
            } else {
                showFallbackLogo();
            }
        });
    }
}

/* ===========================
   CHECKLIST LOGIC
=========================== */
let checkedItems = [];
let itemCategories = [];

/* Reuse existing IDs in DOM for dimension scores */
const dimensionConfig = {
    voice: ['evidence'],
    structure: ['process', 'timeline'],
    nonverbal: ['comms'],
    challenge: ['risk', 'support', 'decision']
};

function initializeChecklist() {
    const checklistContainers = document.querySelectorAll('.checklist-item');
    checkedItems = new Array(checklistContainers.length).fill(false);
    itemCategories = [];

    checklistContainers.forEach((container, index) => {
        const icon = container.querySelector('i');
        const category = container.getAttribute('data-category');
        itemCategories[index] = category;

        container.addEventListener('click', function() {
            // Toggle checkbox
            if (icon.classList.contains('fa-square')) {
                icon.classList.remove('fa-square');
                icon.classList.add('fa-check-square');
                icon.style.color = '#5A4496';
                checkedItems[index] = true;
            } else {
                icon.classList.remove('fa-check-square');
                icon.classList.add('fa-square');
                icon.style.color = '#7B5FC4';
                checkedItems[index] = false;
            }

            updatePresenceScore();
            openStepSidebar(index);
        });
    });
}

function updatePresenceScore() {
    const checkedCount = checkedItems.filter(Boolean).length;
    const totalCount = checkedItems.length;
    const presenceScore = totalCount > 0 ? Math.round((checkedCount / totalCount) * 100) : 0;

    document.getElementById('clarityPercentage').textContent = presenceScore + '%';
    const progressFill = document.getElementById('progressFill');
    progressFill.style.width = presenceScore + '%';

    progressFill.classList.remove('high', 'medium', 'low');
    if (presenceScore >= 75) progressFill.classList.add('high');
    else if (presenceScore >= 40) progressFill.classList.add('medium');
    else progressFill.classList.add('low');

    document.getElementById('generateBtn').disabled = checkedCount === 0;

    const dimensionScores = {
        voice: { checked: 0, total: 0 },
        structure: { checked: 0, total: 0 },
        nonverbal: { checked: 0, total: 0 },
        challenge: { checked: 0, total: 0 }
    };

    itemCategories.forEach((category, index) => {
        Object.keys(dimensionConfig).forEach(dim => {
            if (dimensionConfig[dim].includes(category)) {
                dimensionScores[dim].total += 1;
                if (checkedItems[index]) dimensionScores[dim].checked += 1;
            }
        });
    });

    const voiceScore = dimensionScores.voice.total ? Math.round((dimensionScores.voice.checked / dimensionScores.voice.total) * 100) : 0;
    const structureScore = dimensionScores.structure.total ? Math.round((dimensionScores.structure.checked / dimensionScores.structure.total) * 100) : 0;
    const nonverbalScore = dimensionScores.nonverbal.total ? Math.round((dimensionScores.nonverbal.checked / dimensionScores.nonverbal.total) * 100) : 0;
    const challengeScore = dimensionScores.challenge.total ? Math.round((dimensionScores.challenge.checked / dimensionScores.challenge.total) * 100) : 0;

    document.getElementById('scoreVoice').textContent = voiceScore + '%';
    document.getElementById('scoreStructure').textContent = structureScore + '%';
    document.getElementById('scoreNonverbal').textContent = nonverbalScore + '%';
    document.getElementById('scoreChallenge').textContent = challengeScore + '%';

    refreshStepCompleteButton();
}

/* ===========================
   LEFT STEP SIDEBAR CONTENT
=========================== */
const stepData = [
    {
        title: "Identify the process in play",
        focus: "Different HR routes have different thresholds, wording, and outcomes. Misnaming the process makes you respond to the wrong problem.",
        strong: [
            "You can name the route (capability, conduct, grievance, restructure).",
            "You know what stage you’re at and what comes next.",
            "You know what evidence typically matters in that route."
        ],
        slip: "You treat everything as ‘performance’ and accidentally agree to framing that fits ‘conduct’ or ‘capability’.",
        micro: "Ask one clarifying question in writing: “Can you confirm which formal process this is being handled under, and the next steps?”",
        line: "“To respond accurately, can you confirm whether this is being handled as capability, conduct, or another formal process?”",
        remote: "On calls, ask for the process confirmation in the meeting notes or follow up by email the same day."
    },
    {
        title: "Collect the governing documents",
        focus: "If the policy is the rulebook, you need it. Decisions often reference policy wording — or claim you breached it.",
        strong: [
            "You have the policy, your contract terms, and your job description.",
            "You have objectives/OKRs and any changes documented.",
            "You have all letters/invites related to the matter."
        ],
        slip: "You rely on what HR ‘said’ the policy is — instead of what it actually says.",
        micro: "Create a single folder: Policy + Letters + Objectives + Notes + Evidence.",
        line: "“Please share the relevant policy/documentation that applies to this process so I can prepare properly.”",
        remote: "Ask for documents in advance of meetings. Last-minute files can be used to rush you."
    },
    {
        title: "Run a timeline like a project",
        focus: "Most HR cases are won or lost on timelines: what was raised when, and what was documented at the time.",
        strong: [
            "You have dated entries for key events and decisions.",
            "You record who attended, what was said, and what was agreed.",
            "You capture deadlines and your responses on time."
        ],
        slip: "You keep everything ‘in your head’ — and later it becomes your word vs theirs.",
        micro: "Start a simple log: Date → Event → Who → What happened → Evidence link → Next step.",
        line: "“For clarity, I’ve noted the timeline and next actions. Please confirm if anything is missing.”",
        remote: "Use calendar invites + your own notes. If possible, ask for minutes/notes after each meeting."
    },
    {
        title: "Build a usable evidence pack",
        focus: "HR processes reward what can be verified quickly. Your goal is a clean pack, not a chaotic archive.",
        strong: [
            "Evidence is grouped by theme: outcomes, behaviour, workload, health, changes to objectives.",
            "Each item has a date and context.",
            "You can point to 3–5 strongest artefacts without searching."
        ],
        slip: "You send everything. Too much noise makes your strongest proof invisible.",
        micro: "Create a 1-page index: Claim → Evidence link(s) → Date → Why it matters.",
        line: "“I’ve prepared a short evidence pack indexed to the main points, with dated supporting artefacts.”",
        remote: "Avoid screen-sharing messy folders. Share a tidy doc with links."
    },
    {
        title: "Keep comms procedurally safe",
        focus: "Tone becomes evidence. Professional language protects you — even when you’re upset.",
        strong: [
            "You separate facts from feelings in writing.",
            "You avoid accusations and stick to observable behaviours and dates.",
            "You keep emails short: issue, facts, request, deadline."
        ],
        slip: "You write an emotional essay. It gets quoted against you as ‘unreasonable’ or ‘difficult’.",
        micro: "Use a three-line format: Facts → Impact → Request/Next step.",
        line: "“For the record, the facts are X, Y, Z. My request is A by date B.”",
        remote: "If you’re triggered, draft, wait 30 minutes, then send. Remote misunderstandings escalate fast."
    },
    {
        title: "Confirm outcomes in writing",
        focus: "Verbal agreements are fragile. Written recaps reduce ambiguity and prevent ‘that’s not what we said’.",
        strong: [
            "You send a recap within 24 hours of key meetings.",
            "You list agreed actions, owners, and dates.",
            "You ask for corrections if something is wrong."
        ],
        slip: "You leave meetings relieved — then the narrative gets rewritten in internal notes.",
        micro: "Send a short email: “My understanding is…” + 3 bullets + deadline.",
        line: "“Just to confirm my understanding, the agreed next steps are: 1) … 2) … 3) …”",
        remote: "If it’s a video call, capture the invite, attendees, and your notes immediately afterwards."
    },
    {
        title: "Know your meeting rights and adjustments",
        focus: "You don’t need to be combative — but you do need to be informed, prepared, and supported.",
        strong: [
            "You know whether you can bring a companion/rep.",
            "You can request reasonable adjustments if needed.",
            "You ask for key questions/topics in advance when appropriate."
        ],
        slip: "You walk into a meeting alone, unprepared, and get rushed into agreeing to their framing.",
        micro: "If you need time, ask: “Please confirm the agenda and any documents in advance so I can prepare.”",
        line: "“I’d like to be accompanied at this meeting and receive the agenda/documents in advance.”",
        remote: "Remote meetings can feel informal. Treat them as formal: notes ready, timeline open, calm pacing."
    },
    {
        title: "Spot the narrative risk",
        focus: "Many cases are built around a hidden storyline (reliability, attitude, ‘fit’, capability). If you see the storyline, you can counter it with facts.",
        strong: [
            "You can describe the implied claim in one sentence.",
            "You know what evidence they’re relying on.",
            "You know what evidence neutralises that claim."
        ],
        slip: "You argue the details while missing the bigger accusation being assembled.",
        micro: "Write the implied claim, then list 3 facts that challenge it.",
        line: "“I want to address the underlying concern directly. The factual position is X, supported by Y.”",
        remote: "In remote settings, silence can be misread. Use short, clear written check-ins to reduce misinterpretation."
    },
    {
        title: "Separate facts from interpretation",
        focus: "Interpretations are negotiable. Facts are anchors. Process safety is building anchors.",
        strong: [
            "You challenge claims with dates and examples.",
            "You avoid arguing about motives or feelings.",
            "You can propose a fairer framing."
        ],
        slip: "You get pulled into ‘he said/she said’ instead of ‘here is what happened and when’.",
        micro: "For each claim, ask: “What is the specific example and date?” Then respond with your evidence.",
        line: "“Could you share the specific examples and dates being relied on, so I can respond accurately?”",
        remote: "Ask for claims in writing. It prevents shifting allegations and gives you time to respond calmly."
    },
    {
        title: "Don’t navigate alone",
        focus: "Isolation increases mistakes. Support improves judgement, tone, and strategy.",
        strong: [
            "You have someone to sanity-check emails and notes.",
            "You’re not making decisions mid-stress.",
            "You have a plan for meeting support (companion/rep)."
        ],
        slip: "You try to ‘handle it’ alone and end up reacting instead of responding strategically.",
        micro: "Choose one person: “Can you review this email for tone + clarity before I send?”",
        line: "“I’m taking advice/support to make sure I handle this correctly and professionally.”",
        remote: "Remote work can hide what’s happening. A supporter helps you see patterns you might miss."
    },
    {
        title: "Protect health and capacity properly",
        focus: "If health, stress, workload, or disability factors exist, handle them through the correct channel — calmly and consistently.",
        strong: [
            "You document workload and impact on capacity.",
            "You use appropriate evidence (notes, adjustments requests, workload data).",
            "You keep it factual and non-dramatic."
        ],
        slip: "You only mention health verbally or emotionally, then it disappears from the record.",
        micro: "Write one clear note: “This has impacted X. I’m requesting Y adjustment.”",
        line: "“I want to note that workload/health factors have impacted capacity. I’m requesting [specific] adjustments to enable performance.”",
        remote: "If you’re burnt out, reduce meeting load where possible and move discussions to written form when appropriate."
    },
    {
        title: "Choose your decision path",
        focus: "You need a target. Repair, reset, transfer, or exit — a decision path stops you drifting and gives you leverage.",
        strong: [
            "You know your preferred outcome and your minimum acceptable outcome.",
            "You have a 30/60/90 view of actions.",
            "You’re not making high-stakes decisions while dysregulated."
        ],
        slip: "You focus only on ‘surviving’ the next meeting and lose strategic options over time.",
        micro: "Write: “Best outcome / Minimum outcome / Red lines / Next move if red line is crossed.”",
        line: "“My priority is a fair process and a workable path forward. I’d like clarity on what success looks like and by when.”",
        remote: "Remote can increase ambiguity. Anchor on written commitments: outcomes, timelines, and what ‘good’ looks like."
    }
];

let currentStepIndex = null;

function initializeStepSidebar() {
    const overlay = document.getElementById('stepOverlay');
    const sidebar = document.getElementById('stepSidebar');
    const closeBtn = document.getElementById('closeStepSidebar');

    const prevBtn = document.getElementById('prevStepBtn');
    const nextBtn = document.getElementById('nextStepBtn');
    const toggleCompleteBtn = document.getElementById('toggleStepCompleteBtn');

    if (!overlay || !sidebar || !closeBtn || !prevBtn || !nextBtn || !toggleCompleteBtn) return;

    closeBtn.addEventListener('click', closeStepSidebar);

    overlay.addEventListener('click', (e) => {
        if (e.target === overlay) closeStepSidebar();
    });

    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeStepSidebar();
    });

    prevBtn.addEventListener('click', () => {
        if (currentStepIndex === null) return;
        const nextIndex = Math.max(0, currentStepIndex - 1);
        openStepSidebar(nextIndex);
    });

    nextBtn.addEventListener('click', () => {
        if (currentStepIndex === null) return;
        const nextIndex = Math.min(stepData.length - 1, currentStepIndex + 1);
        openStepSidebar(nextIndex);
    });

    toggleCompleteBtn.addEventListener('click', () => {
        if (currentStepIndex === null) return;
        toggleChecklistItemByIndex(currentStepIndex);
        refreshStepCompleteButton();
    });
}

function openStepSidebar(index) {
    const overlay = document.getElementById('stepOverlay');
    const sidebar = document.getElementById('stepSidebar');

    if (!overlay || !sidebar) return;

    currentStepIndex = index;

    const data = stepData[index] || {};
    document.getElementById('stepBadge').textContent = (index + 1);
    document.getElementById('stepTitle').textContent = data.title || 'Step';
    document.getElementById('stepFocus').textContent = data.focus || '';

    const strongList = document.getElementById('stepStrong');
    strongList.innerHTML = '';
    (data.strong || []).forEach(item => {
        const li = document.createElement('li');
        li.textContent = item;
        strongList.appendChild(li);
    });

    document.getElementById('stepSlip').textContent = data.slip || '';
    document.getElementById('stepMicro').textContent = data.micro || '';
    document.getElementById('stepLine').textContent = data.line || '';
    document.getElementById('stepRemote').textContent = data.remote || '';

    document.getElementById('prevStepBtn').disabled = index === 0;
    document.getElementById('nextStepBtn').disabled = index === (stepData.length - 1);

    refreshStepCompleteButton();

    overlay.classList.add('open');
    sidebar.classList.add('open');
    overlay.setAttribute('aria-hidden', 'false');
}

function closeStepSidebar() {
    const overlay = document.getElementById('stepOverlay');
    const sidebar = document.getElementById('stepSidebar');
    if (!overlay || !sidebar) return;

    overlay.classList.remove('open');
    sidebar.classList.remove('open');
    overlay.setAttribute('aria-hidden', 'true');
}

function toggleChecklistItemByIndex(index) {
    const items = document.querySelectorAll('.checklist-item');
    const target = items[index];
    if (!target) return;

    const icon = target.querySelector('i');
    if (!icon) return;

    if (icon.classList.contains('fa-square')) {
        icon.classList.remove('fa-square');
        icon.classList.add('fa-check-square');
        icon.style.color = '#5A4496';
        checkedItems[index] = true;
    } else {
        icon.classList.remove('fa-check-square');
        icon.classList.add('fa-square');
        icon.style.color = '#7B5FC4';
        checkedItems[index] = false;
    }

    updatePresenceScore();
}

function refreshStepCompleteButton() {
    const btn = document.getElementById('toggleStepCompleteBtn');
    if (!btn || currentStepIndex === null) return;

    const isComplete = !!checkedItems[currentStepIndex];
    btn.innerHTML = isComplete
        ? '<i class="fas fa-rotate-left"></i> Mark as not true'
        : '<i class="fas fa-check"></i> Mark complete';
}

/* ===========================
   SMART SUMMARY
=========================== */
function generateSmartSummary() {
    const checkedCount = checkedItems.filter(Boolean).length;
    const totalCount = checkedItems.length;
    const presenceScore = totalCount > 0 ? Math.round((checkedCount / totalCount) * 100) : 0;

    document.getElementById('summaryScore').textContent = presenceScore + '%';

    const summarySection = document.getElementById('smartSummary');
    summarySection.classList.add('active');
    summarySection.scrollIntoView({ behavior: 'smooth' });

    generateRedFlags();
    generateNextSteps(presenceScore);
    generateRecommendedResources();
}

function generateRedFlags() {
    const redFlagsGrid = document.getElementById('redFlagsGrid');
    redFlagsGrid.innerHTML = '';

    const uncheckedCategories = {};
    checkedItems.forEach((checked, index) => {
        if (!checked) {
            const cat = itemCategories[index];
            uncheckedCategories[cat] = (uncheckedCategories[cat] || 0) + 1;
        }
    });

    const redFlags = [];

    if (uncheckedCategories.process || uncheckedCategories.timeline) {
        redFlags.push({
            title: 'Process/timeline exposure',
            description: 'If the route, stage, and deadlines aren’t clear (and documented), it’s easy to be rushed, misframed, or marked “non-cooperative”.',
            icon: 'fas fa-clock-rotate-left'
        });
    }
    if (uncheckedCategories.evidence) {
        redFlags.push({
            title: 'Evidence gap',
            description: 'Without a tidy evidence pack and chronology, decisions lean on opinion and internal notes — not your reality.',
            icon: 'fas fa-file-circle-xmark'
        });
    }
    if (uncheckedCategories.comms) {
        redFlags.push({
            title: 'Tone risk',
            description: 'Messy comms become evidence. Emotional emails can be used to justify escalation or undermine credibility.',
            icon: 'fas fa-comment-slash'
        });
    }
    if (uncheckedCategories.risk || uncheckedCategories.support) {
        redFlags.push({
            title: 'No protection layer',
            description: 'If you’re not seeing the narrative risk and you’re isolated, you’re more likely to react, miss steps, or accept unfair framing.',
            icon: 'fas fa-shield-halved'
        });
    }
    if (uncheckedCategories.decision) {
        redFlags.push({
            title: 'Drifting without a plan',
            description: 'Without a decision path (repair/reset/transfer/exit), you stay reactive and lose leverage as the process progresses.',
            icon: 'fas fa-route'
        });
    }

    if (redFlags.length === 0) {
        redFlags.push({
            title: 'No major red flags',
            description: 'Your process safety posture is strong. Next gains come from tightening summaries and getting commitments recorded cleanly.',
            icon: 'fas fa-check-circle'
        });
    }

    while (redFlags.length < 3) {
        redFlags.push({
            title: 'Record gap risk',
            description: 'If key decisions aren’t confirmed in writing, the “official record” can drift away from what happened.',
            icon: 'fas fa-clipboard-check'
        });
    }

    redFlags.slice(0, 3).forEach(flag => {
        const card = document.createElement('div');
        card.className = 'red-flag-card';
        card.innerHTML = `
            <div class="flag-icon"><i class="${flag.icon}"></i></div>
            <h4 class="flag-title">${flag.title}</h4>
            <p class="flag-description">${flag.description}</p>
        `;
        redFlagsGrid.appendChild(card);
    });
}

function generateNextSteps(presenceScore) {
    const nextStepsGrid = document.getElementById('nextStepsGrid');
    nextStepsGrid.innerHTML = '';

    let steps = [];

    if (presenceScore >= 75) {
        steps = [
            { title: 'Pre-wire the record', description: 'Send short written recaps after key meetings. Keep a single timeline and confirm the process route/stage in writing.', icon: 'fas fa-pen-to-square' },
            { title: 'Index your evidence', description: 'Create a 1-page evidence index mapped to the main claims/concerns. Keep proof tidy and dated.', icon: 'fas fa-folder-tree' },
            { title: 'Define your path', description: 'Write your 30/60/90 plan: what outcome you’re aiming for, minimum acceptable outcome, and red lines.', icon: 'fas fa-compass' }
        ];
    } else if (presenceScore >= 40) {
        steps = [
            { title: 'Confirm the process + stage', description: 'Ask HR/your manager to confirm the process route, stage, and deadlines so you respond correctly and on time.', icon: 'fas fa-diagram-project' },
            { title: 'Build the timeline + evidence pack', description: 'One timeline log + a tidy evidence folder. Start with the strongest 5–10 artefacts (dated + contextual).', icon: 'fas fa-calendar-check' },
            { title: 'Stabilise comms', description: 'Use the 3-line format (Facts → Impact → Request). Keep everything calm and quotable.', icon: 'fas fa-message' }
        ];
    } else {
        steps = [
            { title: 'Stop reacting in writing', description: 'Pause emotional replies. Draft, wait, then send factual, short messages only.', icon: 'fas fa-hand' },
            { title: 'Get clarity on the route', description: 'Ask which formal process applies and request the policy/agenda/documents in advance.', icon: 'fas fa-sitemap' },
            { title: 'Bring support', description: 'Choose a supporter/rep and do not attend high-stakes meetings unsupported if you can avoid it.', icon: 'fas fa-user-shield' }
        ];
    }

    steps.forEach(step => {
        const card = document.createElement('div');
        card.className = 'next-step-card';
        card.innerHTML = `
            <div class="step-icon"><i class="${step.icon}"></i></div>
            <h4 class="step-title">${step.title}</h4>
            <p class="step-description">${step.description}</p>
        `;
        nextStepsGrid.appendChild(card);
    });
}

function generateRecommendedResources() {
    const resourcesGrid = document.getElementById('resourcesGrid');
    resourcesGrid.innerHTML = '';

    const uncheckedCategories = {};
    checkedItems.forEach((checked, index) => {
        if (!checked) {
            const cat = itemCategories[index];
            uncheckedCategories[cat] = (uncheckedCategories[cat] || 0) + 1;
        }
    });

    const resources = [];

    resources.push({
        title: 'Escalation Documentation Form',
        description: 'A structured form to capture facts, dates, evidence, and next steps so you stay procedurally clean if HR escalates.',
        icon: 'fas fa-file-signature',
        link: 'escalation-documentation-form.html'
    });

    resources.push((uncheckedCategories.timeline || uncheckedCategories.process) ? {
        title: 'Meeting Effectiveness Review',
        description: 'Use this to tighten meeting outcomes, agendas, and follow-ups — so the “official record” doesn’t drift.',
        icon: 'fas fa-clipboard-check',
        link: 'meeting-effectiveness-review.html'
    } : {
        title: 'Priority Reset Plan',
        description: 'A short plan to stabilise workload, reduce errors under pressure, and protect performance while the situation is live.',
        icon: 'fas fa-bullseye',
        link: 'priority-reset-plan.html'
    });

    resources.push((uncheckedCategories.comms || uncheckedCategories.risk) ? {
        title: 'Strategic Interpretation Framework',
        description: 'Translate vague HR/manager language into what is really being alleged, what evidence matters, and what move to make next.',
        icon: 'fas fa-magnifying-glass-chart',
        link: 'strategic-interpretation-framework.html'
    } : {
        title: 'Confidence Rebuild Plan',
        description: 'Protects delivery under stress: calm scripts, self-regulation moves, and a stable “executive tone” when things are tense.',
        icon: 'fas fa-shield',
        link: 'confidence-rebuild-plan.html'
    });

    resources.slice(0, 3).forEach(resource => {
        const card = document.createElement('div');
        card.className = 'resource-card';
        card.innerHTML = `
            <div class="resource-icon"><i class="${resource.icon}"></i></div>
            <h4 class="resource-title">${resource.title}</h4>
            <p class="resource-description">${resource.description}</p>
            <a href="${resource.link}" class="resource-link">
                Access resource <i class="fas fa-arrow-right"></i>
            </a>
        `;
        resourcesGrid.appendChild(card);
    });
}

/* ===========================
   COPY CHECKLIST
=========================== */
function copyChecklist() {
    const checklistName = 'HR & PROCESS SAFETY CHECKLIST';
    const mainHeading = document.querySelector('.hero-main-heading').textContent;
    const checklistItems = document.querySelectorAll('.checklist-text');

    let text = checklistName + '\n';
    text += '=============================\n\n';
    text += mainHeading + '\n\n';
    text += 'NUMBERED CHECKLIST:\n';
    text += '===================\n\n';

    checklistItems.forEach((item, index) => {
        const isChecked = checkedItems[index] ? '[✓]' : '[ ]';
        const cleanText = item.innerText.replace('Open', '').trim();
        text += `${isChecked} ${index + 1}. ${cleanText}\n`;
    });

    const checkedCount = checkedItems.filter(Boolean).length;
    if (checkedCount > 0) {
        const safetyScore = Math.round((checkedCount / checklistItems.length) * 100);
        text += `\nCURRENT STATUS:\n`;
        text += `===============\n`;
        text += `Items checked: ${checkedCount}/${checklistItems.length}\n`;
        text += `Process Safety Score: ${safetyScore}%\n`;
    }

    navigator.clipboard.writeText(text);

    const btn = document.getElementById('copyBtn');
    const originalHTML = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-check"></i> Checklist copied';
    btn.style.background = '#10b981';

    setTimeout(() => {
        btn.innerHTML = originalHTML;
        btn.style.background = '';
    }, 2000);
}

/* ===========================
   MY PLAYBOOK (LOCALSTORAGE)
=========================== */
const PLAYBOOK_KEY = 'tepSavedItems';
const CURRENT_TOOL_ID = 'hr-process-safety-checklist';
const CURRENT_TOOL_TITLE = 'HR & Process Safety Checklist';
const CURRENT_TOOL_TYPE = 'Checklist';

function getSavedItems() {
    try {
        const raw = localStorage.getItem(PLAYBOOK_KEY);
        if (!raw) return [];
        const parsed = JSON.parse(raw);
        return Array.isArray(parsed) ? parsed : [];
    } catch (e) {
        console.warn('Error reading saved items:', e);
        return [];
    }
}

function setSavedItems(items) {
    try { localStorage.setItem(PLAYBOOK_KEY, JSON.stringify(items)); }
    catch (e) { console.warn('Error saving items:', e); }
}

function initializePlaybook() {
    const playbookOverlay = document.getElementById('playbookOverlay');
    const playbookSidebar = document.getElementById('playbookSidebar');
    const playbookButton = document.getElementById('myPlaybookButton');
    const closeBtn = document.getElementById('closePlaybook');
    const saveItemBtn = document.getElementById('saveBtn');

    if (!playbookOverlay || !playbookSidebar || !playbookButton || !closeBtn || !saveItemBtn) return;

    renderSavedItems();

    const savedItems = getSavedItems();
    const isAlreadySaved = savedItems.some(item => item.id === CURRENT_TOOL_ID);
    updateSaveButtonState(saveItemBtn, isAlreadySaved);

    saveItemBtn.addEventListener('click', () => {
        const items = getSavedItems();
        const index = items.findIndex(item => item.id === CURRENT_TOOL_ID);
        let nowSaved;

        if (index === -1) {
            const toolLink = window.location.pathname.split('/').pop() || 'hr-process-safety-checklist.html';
            items.push({
                id: CURRENT_TOOL_ID,
                title: CURRENT_TOOL_TITLE,
                type: CURRENT_TOOL_TYPE,
                link: toolLink,
                savedAt: new Date().toISOString()
            });
            nowSaved = true;
        } else {
            items.splice(index, 1);
            nowSaved = false;
        }

        setSavedItems(items);
        updateSaveButtonState(saveItemBtn, nowSaved);
        renderSavedItems();
    });

    playbookButton.addEventListener('click', () => {
        playbookOverlay.classList.add('open');
        playbookSidebar.classList.add('open');
    });

    closeBtn.addEventListener('click', () => {
        playbookOverlay.classList.remove('open');
        playbookSidebar.classList.remove('open');
    });

    playbookOverlay.addEventListener('click', (e) => {
        if (e.target === playbookOverlay) {
            playbookOverlay.classList.remove('open');
            playbookSidebar.classList.remove('open');
        }
    });
}

function updateSaveButtonState(button, isSaved) {
    if (!button) return;
    const icon = button.querySelector('i');
    const label = button.querySelector('span');

    if (isSaved) {
        button.classList.add('saved');
        if (icon) { icon.classList.remove('far'); icon.classList.add('fas'); }
        if (label) label.textContent = 'Saved';
    } else {
        button.classList.remove('saved');
        if (icon) { icon.classList.remove('fas'); icon.classList.add('far'); }
        if (label) label.textContent = 'Save item';
    }
}

function renderSavedItems() {
    const listEl = document.getElementById('savedItemsList');
    const emptyEl = document.getElementById('savedItemsEmpty');
    if (!listEl || !emptyEl) return;

    const items = getSavedItems();
    listEl.innerHTML = '';

    if (!items.length) {
        emptyEl.style.display = 'block';
        return;
    }

    emptyEl.style.display = 'none';

    items.forEach(item => {
        const li = document.createElement('li');
        li.className = 'saved-item';

        const savedDate = item.savedAt ? new Date(item.savedAt) : null;
        const dateText = savedDate
            ? savedDate.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' })
            : '';

        li.innerHTML = `
            <div class="saved-item-title-row">
                <span class="saved-item-title">${item.title}</span>
                <span class="saved-item-type">${item.type}</span>
            </div>
            <div class="saved-item-meta">
                ${dateText ? `Saved on ${dateText}` : ''}
            </div>
            <a class="saved-item-link" href="${item.link}">
                Open <i class="fas fa-arrow-right"></i>
            </a>
        `;
        listEl.appendChild(li);
    });
}
</script>

</body>
</html>
